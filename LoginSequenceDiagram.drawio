@startuml
actor User
participant "Client" as C
participant "Server" as S
participant "Account DB" as A
participant "Profile DB" as P
User -> C: Nhập username, password
C -> S: POST /api/auth/login {username, password}
S -> A: Tìm account theo username
A --> S: Trả về account (nếu có)
S -> S: Kiểm tra password, trạng thái, xác thực email
alt Không tìm thấy account hoặc sai password
    S --> C: 401 Invalid credentials
else Account bị khóa
    S --> C: 401 Account locked
else Chưa xác thực email (customer)
    S --> C: 401 Email not verified
else Đăng nhập thành công
    S -> P: Lấy profile theo role (customer/staff/admin)
    P --> S: Trả về profile
    S -> S: Tạo JWT token
    S --> C: 200 {token, user info}
end
@enduml